package rmi;

import org.apache.jmeter.protocol.java.sampler.AbstractJavaSamplerClient;
import org.apache.jmeter.protocol.java.sampler.JavaSamplerContext;
import org.apache.jmeter.samplers.SampleResult;

import staff.BookingClient;

public class RMIJavaSampler extends AbstractJavaSamplerClient {
    @Override
    public SampleResult runTest(JavaSamplerContext context) {
        SampleResult result = new SampleResult();
        String serverUrl = context.getParameter("SERVER_URL");
        String portNumber = context.getParameter("PORT_NUMBER");
        result.sampleStart(); // Start the stopwatch

        try {
            BookingClient client = new BookingClient();
            client.main(new String[]{serverUrl, portNumber});

            result.sampleEnd(); // Stop the stopwatch
            result.setSuccessful(true);
            result.setResponseMessage("Successfully performed RMI operation.");
            result.setResponseCodeOK(); // 200 code
        } catch (Exception e) {
            result.sampleEnd(); // Stop the stopwatch
            result.setSuccessful(false);
            result.setResponseMessage("Exception: " + e);
            // Optionally, log the stack trace or handle the error as needed
        }

        return result;
    }
}
